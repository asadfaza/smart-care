# Промпт для интеграции Firebase Firestore с многоязычностью

## Контекст проекта

У меня есть Flask веб-приложение **Smart Care** - демо-сайт для презентации проекта помощи людям с хроническими заболеваниями. Приложение использует компьютерное зрение для анализа продуктов питания.

## Текущая структура проекта

```
safe_care/
├── app.py                 # Flask приложение с данными команды и дорожной карты
├── config.py              # Конфигурация
├── templates/
│   ├── base.html         # Базовый шаблон
│   ├── index.html        # Главная страница с 5 секциями
│   ├── 404.html          # Страница ошибки 404
│   └── 500.html          # Страница ошибки 500
├── static/
│   ├── css/style.css     # Стили
│   └── js/main.js        # JavaScript
└── requirements.txt
```

## Задача

Необходимо интегрировать **Firebase Firestore** для хранения всего текстового контента с поддержкой **двух языков: английский (en) и русский (ru)**.

## Требования к реализации

### 1. Структура данных в Firestore

Создай оптимальную структуру коллекций и документов для хранения:

- **Контент главной страницы** (5 секций):
  - Секция 1: Проблема и Решение (hero, проблема, решение, технологии, статистика, сферы применения)
  - Секция 2: Команда (заголовок, данные членов команды с опытом, обязанностями, ссылками)
  - Секция 3: Почему мы (6 карточек преимуществ, достижения)
  - Секция 4: Дорожная карта (текущий этап, 4 milestone с датами и описаниями, следующие шаги)
  - Секция 5: Реализация (архитектура, технологический стек, этапы, уникальные особенности)

- **Навигация**:
  - Desktop header меню (5 пунктов)
  - Mobile tabs (5 пунктов)

- **Метаданные и SEO**:
  - Title, description, keywords для всех страниц
  - Open Graph теги

- **Страницы ошибок**:
  - 404 и 500 страницы с текстом и кнопками

- **Footer** контент

### 2. Технические требования

#### Backend (Flask):
- Установи и настрой Firebase Admin SDK для Python
- Создай сервис/модуль для работы с Firestore (`services/firestore_service.py`)
- Реализуй функции:
  - Получение контента по ключу и языку
  - Кэширование запросов (Flask-Caching или Redis)
  - Fallback на русский язык, если английского перевода нет
  - Обработка ошибок подключения к Firestore

#### Переключение языка:
- Добавь переключатель языка в header/navbar
- Сохранение выбранного языка в session или cookie
- Автоопределение языка браузера при первом посещении
- Route параметр для языка: `/`, `/en`, `/ru`

#### Структура Flask:
```python
# Примерная структура
@app.route('/')
@app.route('/<lang>')
def index(lang='ru'):
    # Валидация языка
    # Получение контента из Firestore
    # Рендеринг с переводами
    pass
```

### 3. Структура Firestore (предложение)

```
collections/
├── translations/
│   ├── ru/
│   │   ├── navigation (document)
│   │   ├── home_hero (document)
│   │   ├── home_problem (document)
│   │   ├── home_solution (document)
│   │   ├── team (document)
│   │   ├── why_us (document)
│   │   ├── roadmap (document)
│   │   ├── implementation (document)
│   │   ├── footer (document)
│   │   ├── errors (document)
│   │   └── meta (document)
│   └── en/
│       └── (та же структура)
│
├── team_members/ (subcollection)
│   ├── member_1/
│   │   ├── name (string)
│   │   ├── role (object: {ru: "...", en: "..."})
│   │   ├── experience (array)
│   │   ├── responsibilities (object: {ru: "...", en: "..."})
│   │   └── links (object)
│   └── member_2/
│
└── roadmap_milestones/ (subcollection)
    ├── milestone_1/
    │   ├── title (object: {ru: "...", en: "..."})
    │   ├── date (string)
    │   ├── status (string)
    │   └── description (object: {ru: "...", en: "..."})
    └── ...
```

**Или используй другую структуру, если считаешь её более подходящей!**

### 4. Административная панель

Создай простую админ-панель для управления переводами:
- Маршрут: `/admin` (с базовой аутентификацией)
- Возможность редактировать существующие переводы
- Добавление новых ключей перевода
- Просмотр всех переводов в табличном виде
- Синхронизация: если добавляется ключ на русском, автоматически создаётся пустое поле для английского

### 5. Миграция существующих данных

Создай скрипт `migrate_to_firestore.py`, который:
- Извлечёт весь текущий текст из шаблонов и `app.py`
- Структурирует его согласно схеме Firestore
- Загрузит русские данные в Firestore
- Создаст пустые/заглушечные записи для английского языка (которые можно потом заполнить)

### 6. Обновление шаблонов

Измени шаблоны Jinja2 для использования переводов:

```jinja
{# Вместо: #}
<h1>Smart Care</h1>

{# Используй: #}
<h1>{{ translations.home_hero.title }}</h1>
```

### 7. Конфигурация Firebase

- Добавь в `config.py` настройки Firebase:
  - Путь к файлу сервисного аккаунта JSON
  - Database URL
  - Настройки кэширования
- Не забудь добавить `firebase-credentials.json` в `.gitignore`
- Создай `firebase-credentials.example.json` с структурой для документации

### 8. Обновление зависимостей

Добавь в `requirements.txt`:
```
firebase-admin==6.3.0
Flask-Caching==2.1.0
python-dotenv==1.0.0
```

### 9. Производительность и оптимизация

- Реализуй кэширование переводов (время жизни: 1 час)
- При старте приложения загрузи все переводы в память
- Используй connection pooling для Firestore
- Добавь логирование запросов к Firestore для мониторинга

### 10. Документация

Создай файл `FIRESTORE_SETUP.md` с инструкциями:
- Как настроить Firebase проект
- Как получить credentials.json
- Как запустить миграцию данных
- Структура данных в Firestore
- Как добавлять новые переводы

### 11. Дополнительные фичи (опционально)

- API endpoint для получения переводов: `/api/translations/<lang>`
- Версионирование переводов (сохранение истории изменений)
- Возможность переводить через Google Translate API автоматически
- A/B тестирование разных вариантов текстов
- Экспорт/импорт переводов в JSON/CSV для переводчиков

## Текущий контент, который нужно перенести

### Данные команды (из app.py):
```python
TEAM_DATA = [
    {
        'name': 'Асадбек Фазлиддинов',
        'role': 'Team Lead & Developer',
        'experience': ['Yandex Taxi', 'Uzum Market'],
        'responsibilities': 'Руководство командой, разработка backend...',
        'links': {...}
    },
    {
        'name': 'Сайдулло Султонов',
        'role': 'Business Researcher',
        ...
    }
]
```

### Дорожная карта (из app.py):
```python
ROADMAP_DATA = {
    'current_stage': 'MVP Development',
    'milestones': [
        {
            'title': 'Исследование и концепция',
            'date': 'Ноябрь 2024',
            'status': 'completed',
            'description': 'Анализ проблемы...'
        },
        ...
    ]
}
```

### Навигация (из index.html):
- Desktop: Главная, Команда, Почему мы, Дорожная карта, Реализация
- Mobile: Главная, Команда, О нас, Карта, План

### Весь остальной текст из шаблонов (заголовки, описания, кнопки, статистика и т.д.)

## Ожидаемый результат

После интеграции:

1. ✅ Весь текст хранится в Firestore (ничего не хардкодится в коде)
2. ✅ Поддержка двух языков (русский и английский) с лёгким переключением
3. ✅ Простая админ-панель для редактирования переводов
4. ✅ Скрипт миграции успешно переносит текущий контент
5. ✅ Кэширование для быстрой загрузки
6. ✅ Документация по настройке и использованию
7. ✅ Приложение работает стабильно и быстро

## Важные замечания

- **НЕ** удаляй существующий функционал
- **СОХРАНИ** текущий дизайн и структуру (только добавь переводы)
- **ОБЕСПЕЧЬ** обратную совместимость
- **ОБРАБОТАЙ** все возможные ошибки (нет интернета, Firestore недоступен и т.д.)
- **НАПИШИ** понятный и чистый код с комментариями

## Начни с:

1. Настройки Firebase проекта и получения credentials
2. Создания структуры в Firestore
3. Реализации базового firestore_service.py
4. Миграции существующих данных
5. Обновления одного шаблона для тестирования
6. Расширения на остальные шаблоны
7. Создания админ-панели
8. Тестирования и оптимизации

---

**Пожалуйста, реализуй эту интеграцию поэтапно, предоставляя полный код для каждого файла и подробные объяснения. Начни с создания структуры Firestore и сервиса для работы с ним.**

